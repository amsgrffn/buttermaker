{{!< default}}
<!-- DEBUG: AUTHOR.HBS IS RENDERING -->

<div class="split-content-wrapper">
	<div class="main-content-area">

		{{!-- Author Archive Header --}}
		<header class="archive-header">
			<ul class="breadcrumb-list">
				<li class="breadcrumb-item home">
					{{> "icons/map-pin"}}
					<a class="title" href="{{@site.url}}">Home</a>
				</li>
				<li class="breadcrumb-separator">{{> "icons/chevron"}}</li>
				<li class="breadcrumb-item">Authors</li>
				<li class="breadcrumb-separator">{{> "icons/chevron"}}</li>
				{{#author}}
					<li class="breadcrumb-item current">{{name}}</li>
				{{/author}}
			</ul>

			{{#author}}
			<div class="archive-title-wrapper">
				{{!-- Author Avatar --}}
				{{#if profile_image}}
					<img
						class="author-archive-avatar"
						srcset="{{img_url profile_image size='s' format='webp'}} 100w,
								{{img_url profile_image size='m' format='webp'}} 200w"
						sizes="120px"
						src="{{img_url profile_image size='m' format='webp'}}"
						alt="{{name}}"
						width="120"
						height="120"
						loading="eager">
				{{/if}}

				<h2 class="archive-title">{{name}}</h2>

				{{#if bio}}
					<p class="archive-description">{{bio}}</p>
				{{/if}}

				{{#if location}}
					<p class="author-location">üìç {{location}}</p>
				{{/if}}

				{{#if website}}
					<p class="author-website">
						<a href="{{website}}" target="_blank" rel="noopener">üîó {{website}}</a>
					</p>
				{{/if}}

				<p class="archive-count">{{plural count.posts empty='No posts' singular='% post' plural='% posts'}}</p>
			</div>
			{{/author}}
		</header>

		{{!-- Debug Pagination Info --}}
		{{!-- Remove this after testing --}}
		<div style="background: yellow; padding: 20px; margin: 20px;">
			<strong>DEBUG INFO:</strong><br>
			Posts count: {{posts.length}}<br>
			Pagination exists: {{#if pagination}}YES{{else}}NO{{/if}}<br>
			{{#if pagination}}
				Current page: {{pagination.page}}<br>
				Total pages: {{pagination.pages}}<br>
				Has next: {{#if pagination.next}}YES{{else}}NO{{/if}}<br>
				Total posts: {{pagination.total}}<br>
				Limit: {{pagination.limit}}<br>
			{{/if}}
		</div>

		{{!-- Masonry Grid Section --}}
		<section class="featured-masonry-section">
			<div class="masonry-grid">
				{{#foreach posts}}
					<article class="masonry-card" data-tags="{{#foreach tags}}{{slug}} {{/foreach}}">
						{{#if feature_image}}
							<div class="masonry-image">
								<img
									srcset="{{img_url feature_image size='s' format='webp'}} 400w,
											{{img_url feature_image size='m' format='webp'}} 800w"
									sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 400px"
									src="{{img_url feature_image size='m' format='webp'}}"
									alt="{{title}}"
									width="800"
									height="600"
									loading="lazy">
							</div>
						{{/if}}
						<div class="masonry-content">
							<h3 class="masonry-title">
								<a href="{{url}}">{{title}}</a>
							</h3>
							<div class="masonry-excerpt">{{excerpt words="25"}}</div>
							<div class="masonry-meta">
								{{#primary_author}}
									<a class="avatar wiggle" href="{{url}}">
										<img
											srcset="{{img_url profile_image size='xxs' format='webp'}} 50w,
													{{img_url profile_image size='xs' format='webp'}} 100w"
											sizes="50vw"
											src="{{img_url profile_image size='xs' format='webp'}}"
											alt="{{name}}'s Avatar"
											width="40"
											height="40"
											loading="lazy" />
									</a>
								{{/primary_author}}
								&middot;
								<time datetime="{{date published_at format='YYYY-MM-DD'}}">
									{{date published_at timeago="true"}}
								</time>
								{{#if primary_tag}}
									&middot; <span class="masonry-tag">{{primary_tag.name}}</span>
								{{/if}}
							</div>
						</div>
						<a href="{{url}}" class="masonry-link" aria-label="Read {{title}}"></a>
					</article>
				{{/foreach}}
			</div>

			{{!-- Load More Button --}}
			{{#if pagination.next}}
				<div class="load-more">
					<button id="load-more-btn" type="button" aria-label="Load more posts">
						Load More Posts
					</button>
				</div>
			{{/if}}

			{{!-- Pagination Data --}}
			{{#if pagination}}
				<script type="application/json" id="pagination-data">
				{
					"currentPage": {{pagination.page}},
					"totalPages": {{pagination.pages}},
					"hasNext": {{#if pagination.next}}true{{else}}false{{/if}},
					"hasPrev": {{#if pagination.prev}}true{{else}}false{{/if}},
					"total": {{pagination.total}},
					"limit": {{pagination.limit}}
				}
				</script>
			{{/if}}
		</section>
	</div>

	<aside class="content-aside">
		{{> "layout/aside-content"}}
	</aside>
</div>