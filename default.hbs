<!DOCTYPE html>
<html lang="{{@site.locale}}">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
     <script>
        (function() {
            const savedTheme = localStorage.getItem('theme-preference');
            const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const shouldUseDarkMode = savedTheme === 'dark' || (!savedTheme && systemPrefersDark);

            if (shouldUseDarkMode) {
                document.documentElement.setAttribute('data-theme', 'dark');
                document.documentElement.classList.add('dark-mode');
            } else {
                document.documentElement.setAttribute('data-theme', 'light');
            }
            document.documentElement.classList.remove('no-js');
        })();
    </script>
    <style>
        /* Critical inline CSS to prevent flash - applies dark mode immediately */
        html[data-theme="dark"] {
            background-color: #0f0f0f;
            color: #e5e5e5;
        }
        html[data-theme="dark"] body {
            background-color: #0f0f0f;
            color: #e5e5e5;
        }
    </style>
	{{!-- Performance: Resource Hints --}}
	<link rel="preconnect" href="https://use.typekit.net" crossorigin>
	<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
	<link rel="dns-prefetch" href="https://use.typekit.net">
	<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

	{{!-- Preload critical resources --}}
	<link rel="preload" href="{{asset "built/screen.css"}}" as="style">
	<link rel="preload" href="{{asset "built/script.js"}}" as="script" crossorigin>

	<title>{{meta_title}}</title>
	{{#is "home, index, tag, author"}}
	   {{ghost_head exclude="card_assets"}}
	{{else}}
	   {{ghost_head}}
	{{/is}}

	{{!-- Critical CSS --}}
	<link rel="stylesheet" type="text/css" href="{{asset "built/screen.css"}}">

	{{!-- Non-blocking font loading --}}
	<link rel="stylesheet" href="https://use.typekit.net/unt3hxg.css" media="print" onload="this.media='all'">
	<noscript><link rel="stylesheet" href="https://use.typekit.net/unt3hxg.css"></noscript>
</head>

<body class="{{body_class}}">
	{{> "layout/site-header"}}

	<div class="layout">
		{{> "layout/sidebar"}}
		<main class="main-content">
			{{{body}}}
		</main>
	</div>

	{{{block "scripts"}}}
	{{ghost_foot}}

	{{!-- Main theme JavaScript (ES module for code-splitting) --}}
	<script type="module" src="{{asset "built/script.js"}}"></script>

	{{!-- External lite-youtube module --}}
	<script
		type="module"
		src="https://cdn.jsdelivr.net/npm/@justinribeiro/lite-youtube@1/lite-youtube.min.js"
		crossorigin="anonymous">
	</script>

	{{> "utilities/livereload"}}
</body>
</html>
