<!DOCTYPE html>
<html lang="{{@site.locale}}">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>{{meta_title}}</title>
	{{! Ghost outputs meta description automatically in ghost_head }}

	{{! Ghost head for SEO, analytics, etc }}
	{{ghost_head}}

	{{! Theme styles }}
	<link rel="stylesheet" type="text/css" href="{{asset "built/screen.css"}}">
	<link rel="preload" href="https://use.typekit.net/unt3hxg.css" as="style">
	<link rel="stylesheet" href="https://use.typekit.net/unt3hxg.css">
</head>
<body class="{{body_class}}">
	{<header class="top-header">
		<div class="header-content">
			<div class="header-left">
				<button class="mobile-menu-btn" onclick="toggleSidebar()">â˜°</button>
				<a href="{{@site.url}}" class="logo"><img src="{{asset "img/nyc.png"}}" alt="{{title}}"></a>
				<ul>
					<li>{{date format="dddd, MMMM Do YYYY"}}. Currently: <a href="https://en.wikipedia.org/wiki/Maine"><span id="current-temp"></span>,<span id="current-condition"></span></a></li>
				</ul>
			</div>
			<div class="header-center">
				<div class="search-bar">
					<input type="text" class="search-input" placeholder="Search {{@site.title}}">
					<span class="search-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search-icon lucide-search"><path d="m21 21-4.34-4.34"/><circle cx="11" cy="11" r="8"/></svg></span>
				</div>
			</div>
			<div class="header-right">
				{{#unless @member}}
					<a href="#/portal/signin" class="header-btn" data-portal="signin">Member Login</a>
					<a href="#/portal/signup" class="header-btn primary" data-portal="signup">Subscribe</a>
				{{else}}
					<a href="#/portal/account" class="header-btn" data-portal="account">Account</a>
				{{/unless}}
			</div>
		</div>
	</header>

	<div class="layout">
		{{! Sidebar }}
		{{! Sidebar with Hard-coded Dropdown Lists }}
		<aside class="sidebar">
			<nav>
				<h1>You <span>can't</span> be serious.</h1>
				<p class="tagline">An optimists guide to maintaining equanimity and sanity during an age of bullshit</p>
				<ul class="sidebar-nav">
					{{! Home - with dropdown }}
					<li>
						<a href="{{@site.url}}" class="sidebar-link">
							<span class="nav-icon">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-right-icon lucide-arrow-right">
									<path d="M5 12h14"/>
									<path d="m12 5 7 7-7 7"/>
								</svg>
							</span>
							Home
						</a>
					</li>

					{{! Blog - regular link (no dropdown) }}
					<li>
						<a href="{{@site.url}}/blog/" class="sidebar-link">
							<span class="nav-icon">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-right-icon lucide-arrow-right">
									<path d="M5 12h14"/>
									<path d="m12 5 7 7-7 7"/>
								</svg>
							</span>
							Blog
						</a>
					</li>

					{{! Topics - with dropdown (customize with your actual tags) }}
					<li class="has-dropdown" data-dropdown-type="topics">
						<a href="{{@site.url}}/topics/" class="sidebar-link">
							<span class="nav-icon">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus-icon lucide-plus">
									<path d="M5 12h14"></path>
									<path d="M12 5v14"></path>
								</svg>
							</span>
							Topics
						</a>
						<div class="dropdown-submenu">
							<ul>
								{{! Replace these with your actual tags/topics }}
								<li><a href="{{@site.url}}/tag/poetry/" class="dropdown-link">Poetry</a></li>
								<li><a href="{{@site.url}}/tag/fiction/" class="dropdown-link">Fiction</a></li>
								<li><a href="{{@site.url}}/tag/art/" class="dropdown-link">Art</a></li>
								<li><a href="{{@site.url}}/tag/writing/" class="dropdown-link">Writing</a></li>
								<li><a href="{{@site.url}}/tag/photography/" class="dropdown-link">Photography</a></li>
								<li><a href="{{@site.url}}/tag/culture/" class="dropdown-link">Culture</a></li>
							</ul>
						</div>
					</li>

					{{! Pages - with dropdown (customize with your actual pages) }}
					<li class="has-dropdown" data-dropdown-type="pages">
						<a href="{{@site.url}}/pages/" class="sidebar-link">
							<span class="nav-icon">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus-icon lucide-plus">
									<path d="M5 12h14"></path>
									<path d="M12 5v14"></path>
								</svg>
							</span>
							Pages
						</a>
						<div class="dropdown-submenu">
							<ul>
								{{! Replace these with your actual pages }}
								<li><a href="{{@site.url}}/about/" class="dropdown-link">About</a></li>
								<li><a href="{{@site.url}}/contact/" class="dropdown-link">Contact</a></li>
								<li><a href="{{@site.url}}/portfolio/" class="dropdown-link">Portfolio</a></li>
								<li><a href="{{@site.url}}/services/" class="dropdown-link">Services</a></li>
								<li><a href="{{@site.url}}/faq/" class="dropdown-link">FAQ</a></li>
							</ul>
						</div>
					</li>

					{{! Archive - regular link (no dropdown) }}
					<li>
						<a href="{{@site.url}}/archive/" class="sidebar-link">
							<span class="nav-icon">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-right-icon lucide-arrow-right">
									<path d="M5 12h14"/>
									<path d="m12 5 7 7-7 7"/>
								</svg>
							</span>
							Archive
						</a>
					</li>

					{{! Legal - with dropdown }}
					<li class="has-dropdown" data-dropdown-type="legal">
						<a href="{{@site.url}}/legal/" class="sidebar-link">
							<span class="nav-icon">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus-icon lucide-plus">
									<path d="M5 12h14"></path>
									<path d="M12 5v14"></path>
								</svg>
							</span>
							Legal
						</a>
						<div class="dropdown-submenu">
							<ul>
								<li><a href="{{@site.url}}/privacy/" class="dropdown-link">Privacy Policy</a></li>
								<li><a href="{{@site.url}}/terms/" class="dropdown-link">Terms of Service</a></li>
								<li><a href="{{@site.url}}/cookies/" class="dropdown-link">Cookie Policy</a></li>
								<li><a href="{{@site.url}}/disclaimer/" class="dropdown-link">Disclaimer</a></li>
							</ul>
						</div>
					</li>
				</ul>
			</nav>

			{{! Your existing Now Reading Widget stays exactly the same }}
			<div class="now-reading-widget">
				<ul>
					<li>You Can't Be Serious is built and maintained in Maine with <a href="https://ghost.org">Ghost</a> + <a href="https://www.magicpages.co/">Magic Pages</a> + <a href="https://github.com/amsgrffn/buttermaker">Buttermaker</a>. The New York Knicks won an NBA Championship <a href="https://www.nytimes.com/1973/05/11/archives/knicks-win-title-top-lakers-10293-new-york-triumphs-in-five-games.html?unlocked_article_code=1.p04.Ennw.Aq7vqriHBZPh&smid=url-share"><span id="knicks-counter"></span></a>.</li>
				</ul>
				<div class="widget-controls">
					<a href="{{@site.url}}/rss/" class="widget-btn" title="RSS Feed">{{> "icons/rss"}}</a>
					<a href="#/portal/" class="widget-btn" title="Subscribe" data-portal="signup">{{> "icons/mail"}}</a>
					<a href="#/portal/" class="widget-btn" title="Subscribe" data-portal="signup">{{> "icons/bluesky"}}</a>
					<a href="#/portal/" class="widget-btn" title="Subscribe" data-portal="signup">{{> "icons/letterboxd"}}</a>
				</div>
				<div class="widget-footer">
					<p class="copyright">Â© {{date format="YYYY"}} You Can't Be Serious</p>
				</div>
			</div>
		</aside>

		{{! Sidebar Overlay for Mobile }}
		<div class="sidebar-overlay" onclick="toggleSidebar()"></div>

		{{! Main Content }}
		<main class="main-content">
			{{{body}}}
		</main>
	</div>

	{{! Ghost foot for member portal, analytics, etc }}
	{{ghost_foot}}

	{{! Theme JavaScript }}
	<script src="{{asset "built/script.js"}}"></script>
	{{!-- Add this to default.hbs right before </body> tag --}}
	{{!-- Development auto-refresh for HBS files --}}
	<script>
		// Only run in development (when localhost)
		if (location.hostname === 'localhost' || location.hostname === '127.0.0.1') {
			console.log('ðŸ”„ Development mode: Auto-refresh enabled');

			let lastModified = null;
			let checkInterval = null;

			// Function to check if page was modified
			async function checkForChanges() {
				try {
					const response = await fetch(location.href, {
						method: 'HEAD',
						cache: 'no-cache'
					});

					const currentModified = response.headers.get('last-modified');
					const currentEtag = response.headers.get('etag');

					// Use both last-modified and etag for better detection
					const pageSignature = currentModified + currentEtag;

					if (lastModified && lastModified !== pageSignature) {
						console.log('ðŸ”„ Page changed, refreshing...');
						location.reload();
					}

					lastModified = pageSignature;
				} catch (error) {
					// Silently handle errors (might be network issues)
				}
			}

			// Check every 2 seconds
			checkInterval = setInterval(checkForChanges, 2000);

			// Initial check after 1 second
			setTimeout(checkForChanges, 1000);

			// Cleanup when page unloads
			window.addEventListener('beforeunload', () => {
				if (checkInterval) {
					clearInterval(checkInterval);
				}
			});
		}
	</script>
</body>
</html>