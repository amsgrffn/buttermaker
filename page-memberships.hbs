{{!< default}}


{{#page}}
{{> "components/breadcrumb-nav"}}

<div class="container-without-sidebar">
    <main class="post-or-page membership-page">

        {{!-- Page Header --}}
        <header class="membership-header">
            <h1 class="page-title">{{title}}</h1>
            {{#if custom_excerpt}}
                <p class="page-excerpt">{{custom_excerpt}}</p>
            {{/if}}
        </header>

        {{!-- Membership Content Wrapper --}}
        <div class="membership-content">

            {{!-- Membership Cards Section --}}
            <section class="membership-section">
                {{#if @site.paid_members_enabled}}
                    <div class="membership-toggle-wrapper">
                        <div class="membership-toggle" data-active-price="{{@site.portal_default_plan}}" data-active-price-plans="{{@site.portal_plans}}">
                            <button class="active" data-price="monthly">Pay {{t "Monthly"}}</button>
                            <button data-price="yearly">Pay {{t "Yearly"}} <span>up to 17% off</span></button>
                        </div>
                    </div>
                {{/if}}

                <div class="membership-cards">
                    {{!-- Free Tier --}}
                    {{^if @member}}
                        {{#get "tiers" include="benefits" filter="visibility:public+type:free"}}
                            {{#foreach tiers}}
                                <div class="membership-card">
                                    <div class="membership-card-header">

                                        <h2 class="membership-card-title"><span>{{name}}</span></h2>
                                        <div class="membership-card-tag">Free as in beer</div>
                                    </div>
                                    <div class="membership-card-price" data-monthly>
                                        {{#if monthly_price}}${{price monthly_price}}<span>/{{t "month"}}</span>{{else}}Free{{/if}}
                                    </div>
                                    <div class="membership-card-price" data-yearly style="display: none;">
                                        {{#if yearly_price}}${{price yearly_price}}<span>/{{t "year"}}</span>{{else}}Free{{/if}}
                                    </div>
                                    {{#if description}}
                                        <p class="membership-card-description">{{description}}</p>
                                    {{/if}}
                                    <a href="{{@site.url}}/signup/" class="membership-card-button">{{t "Sign up for free"}}</a>
                                    {{#if benefits}}
                                        <ul class="membership-features-list">
                                            {{#foreach benefits as |benefit|}}
                                                <li>{{benefit}}</li>
                                            {{/foreach}}
                                        </ul>
                                    {{/if}}
                                </div>
                            {{/foreach}}
                        {{/get}}
                    {{/if}}

                    {{!-- Paid Tiers --}}
                    {{#if @site.paid_members_enabled}}
                        {{#get "tiers" include="monthly_price,yearly_price,benefits" filter="visibility:public+type:paid" limit="all"}}
                            {{#foreach tiers}}
                                <div class="membership-card">
                                    <div class="membership-card-header">

                                        <h2 class="membership-card-title"><span>{{name}}</span></h2>
                                        {{#if trial_days}}
                                            <div class="membership-card-tag">{{trial_days}} days free trial</div>
                                        {{/if}}
                                    </div>
                                    <div class="membership-card-price" data-monthly>
                                        {{#if monthly_price}}${{price monthly_price}}<span>/{{t "month"}}</span>{{else}}$0<span>/{{t "month"}}</span>{{/if}}
                                    </div>
                                    <div class="membership-card-price" data-yearly style="display: none;">
                                        {{#if yearly_price}}${{price yearly_price}}<span>/{{t "year"}}</span>{{else}}$0<span>/{{t "year"}}</span>{{/if}}
                                    </div>
                                    {{#if description}}
                                        <p class="membership-card-description">{{description}}</p>
                                    {{/if}}
                                    <a href="javascript:" data-portal="signup/{{id}}/monthly" class="membership-card-button" data-monthly>
                                        {{#if trial_days}}{{t "Start {trial}-day free trial" trial=trial_days}}{{else}}{{t "Start 14 day free trial"}}{{/if}}
                                    </a>
                                    <a href="javascript:" data-portal="signup/{{id}}/yearly" class="membership-card-button" data-yearly style="display: none;">
                                        {{#if trial_days}}{{t "Start {trial}-day free trial" trial=trial_days}}{{else}}{{t "Start 14 day free trial"}}{{/if}}
                                    </a>
                                    {{#if benefits}}
                                        <ul class="membership-features-list">
                                            {{#foreach benefits as |benefit|}}
                                                <li>{{benefit}}</li>
                                            {{/foreach}}
                                        </ul>
                                    {{/if}}
                                </div>
                            {{/foreach}}
                        {{/get}}
                    {{/if}}
                </div>

                <div class="membership-footnote">
                    <p>All memberships auto-renew after a free trial ends but can be cancelled anytime. By joining, you agree to our <a href="/terms">Terms of Service</a>.</p>
                </div>
            </section>

            {{!-- Page Content Section - This is where Ghost editor content appears --}}
            <div class="post-content">
                {{content}}
            </div>

        </div>

        {{!-- Page Footer --}}
        <footer class="page-footer">
            <p>{{title}} was created on {{date format="M/D/YYYY"}}. {{#match updated at}}Updated on <time class="updated" datetime="{{updated_at}}">{{date updated_at format="M/D/YYYY"}}</time>.{{/match}}</p>
        </footer>

    </main>
</div>
{{/page}}

{{> "layout/site-footer"}}

{{#contentFor "scripts"}}
<script>
    // Price toggle functionality
    document.addEventListener('DOMContentLoaded', function() {
        const toggleBtns = document.querySelectorAll('.membership-toggle button');
        const monthlyElements = document.querySelectorAll('[data-monthly]');
        const yearlyElements = document.querySelectorAll('[data-yearly]');

        // Set initial state based on active button
        const activeBtn = document.querySelector('.membership-toggle button.active');
        if (activeBtn) {
            const activePrice = activeBtn.dataset.price;
            if (activePrice === 'yearly') {
                monthlyElements.forEach(el => el.style.display = 'none');
                yearlyElements.forEach(el => el.style.display = el.tagName === 'A' ? 'block' : '');
            }
        }

        // Toggle button click handler
        toggleBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                // Remove active class from all buttons
                toggleBtns.forEach(b => b.classList.remove('active'));
                // Add active class to clicked button
                this.classList.add('active');

                const priceType = this.dataset.price;

                if (priceType === 'monthly') {
                    monthlyElements.forEach(el => {
                        el.style.display = el.tagName === 'A' ? 'block' : '';
                    });
                    yearlyElements.forEach(el => {
                        el.style.display = 'none';
                    });
                } else {
                    monthlyElements.forEach(el => {
                        el.style.display = 'none';
                    });
                    yearlyElements.forEach(el => {
                        el.style.display = el.tagName === 'A' ? 'block' : '';
                    });
                }
            });
        });
    });

    // Income Slider (Sliding Scale) functionality
    class SlidingScale {
        constructor() {
            // Insert the slider HTML before the membership cards
            this.insertSliderHTML();

            // Initialize the slider and highlighting functionality
            this.init();
        }

        insertSliderHTML() {
            const membershipSection = document.querySelector('.membership-section');
            const sliderHTML = `
                <div class="income-slider-section">
                    <div class="slider-card">
                        <div class="slider-header">
                            <h2><span>Select Your Income Level</span></h2>
                            <p>Membership pricing is based on individual annual income</p>
                        </div>
                        <div class="slider-content">
                            <div class="income-display">Annual Income: $<span id="income-display">40,000</span></div>
                            <input type="range" id="income-slider"
                                   min="20000" max="150000"
                                   step="1000" value="40000"
                                   class="income-slider">
                        </div>
                    </div>
                </div>
            `;

            // Insert at the beginning of the membership section
            membershipSection.insertAdjacentHTML('afterbegin', sliderHTML);

            // Now move the toggle after the slider
            const toggleWrapper = membershipSection.querySelector('.membership-toggle-wrapper');
            const sliderSection = membershipSection.querySelector('.income-slider-section');

            if (toggleWrapper && sliderSection) {
                // Move toggle after slider
                sliderSection.after(toggleWrapper);
            }
        }

        getTierFromIncome(income) {
            if (income < 40000) return 3;
            if (income < 85000) return 6;
            return 12;
        }

        highlightTier(price) {
            // Remove highlight from all cards
            const cards = document.querySelectorAll('.membership-card');
            cards.forEach(card => {
                card.classList.remove('highlight-tier');
                card.style.transform = '';
                if (card.querySelector('.recommended-badge')) {
                    card.querySelector('.recommended-badge').remove();
                }
            });

            // Find and highlight the appropriate card
            cards.forEach(card => {
                const priceElement = card.querySelector('.membership-card-price[data-monthly]');
                if (!priceElement) return;

                const cardPrice = parseFloat(priceElement.textContent.replace('$', ''));
                if (cardPrice === price) {
                    card.classList.add('highlight-tier');
                    card.style.transform = 'translateY(-8px)';

                    // Add recommended badge
                    const header = card.querySelector('.membership-card-header');
                    const badge = document.createElement('div');
                    badge.className = 'recommended-badge';
                    badge.textContent = 'Recommended';
                    header.insertBefore(badge, header.firstChild);
                }
            });
        }

        init() {
            const slider = document.getElementById('income-slider');
            const incomeDisplay = document.getElementById('income-display');

            slider.addEventListener('input', (e) => {
                const income = parseInt(e.target.value);
                incomeDisplay.textContent = income >= 150000 ? '150,000+' : income.toLocaleString();

                const suggestedPrice = this.getTierFromIncome(income);
                this.highlightTier(suggestedPrice);
            });

            // Initial highlight
            const initialIncome = parseInt(slider.value);
            const initialPrice = this.getTierFromIncome(initialIncome);
            this.highlightTier(initialPrice);
        }
    }

    // Initialize the sliding scale when the DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
        new SlidingScale();
    });
</script>
{{/contentFor}}
